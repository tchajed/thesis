\begin{Verbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1,codes={\catcode`\$=3\catcode`\^=7\catcode`\_=8},fontsize=\small,numbersep=6pt,xleftmargin=0.2in]
\PY{k+kd}{func} \PY{p}{(}\PY{n+nx}{l} \PY{o}{*}\PY{n+nx}{Wal}\PY{p}{)} \PY{n+nx}{Read}\PY{p}{(}\PY{n+nx}{a} \PY{k+kt}{uint64}\PY{p}{)} \PY{n+nx}{Block} \PY{p}{\PYZob{}}
  \PY{n+nx}{b}\PY{p}{,} \PY{n+nx}{ok} \PY{o}{:=} \PY{n+nx}{l}\PY{p}{.}\PY{n+nx}{ReadMem}\PY{p}{(}\PY{n+nx}{a}\PY{p}{)}
  \PY{k}{if} \PY{n+nx}{ok} \PY{p}{\PYZob{}}
    \PY{k}{return} \PY{n+nx}{b}
  \PY{p}{\PYZcb{}}
  \PY{k}{return} \PY{n+nx}{l}\PY{p}{.}\PY{n+nx}{ReadInstalled}\PY{p}{(}\PY{n+nx}{a}\PY{p}{)}
\PY{p}{\PYZcb{}}

\PY{k+kd}{func} \PY{p}{(}\PY{n+nx}{l} \PY{o}{*}\PY{n+nx}{Wal}\PY{p}{)} \PY{n+nx}{ReadMem}\PY{p}{(}\PY{n+nx}{a}\PY{p}{)} \PY{p}{(}\PY{n+nx}{Block}\PY{p}{,} \PY{k+kt}{bool}\PY{p}{)} \PY{p}{\PYZob{}}
  \PY{n+nx}{l}\PY{p}{.}\PY{n+nx}{Lock}\PY{p}{(}\PY{p}{)}
  \PY{c+c1}{// get b from in\PYZhy{}memory log, if present}
  \PY{n+nx}{l}\PY{p}{.}\PY{n+nx}{Unlock}\PY{p}{(}\PY{p}{)}
  \PY{k}{return} \PY{n+nx}{b}\PY{p}{,} \PY{n+nx}{ok}
\PY{p}{\PYZcb{}}

\PY{k+kd}{func} \PY{p}{(}\PY{n+nx}{l} \PY{o}{*}\PY{n+nx}{Wal}\PY{p}{)} \PY{n+nx}{ReadInstalled}\PY{p}{(}\PY{n+nx}{a} \PY{k+kt}{uint64}\PY{p}{)} \PY{n+nx}{Block} \PY{p}{\PYZob{}}
  \PY{k}{return} \PY{n+nx}{disk}\PY{p}{.}\PY{n+nx}{Read}\PY{p}{(}\PY{n+nx}{a}\PY{p}{)}
\PY{p}{\PYZcb{}}
\end{Verbatim}
